import time
import sys
import sqlite3

if len(sys.argv) < 3:
    print("error: python3 expoit-cryptohash.py [hashvalue] [dict_db]")
    sys.exit()

_, test_hash, dict_db = sys.argv
test_hash = test_hash.lower()

start_time = time.time()

con = sqlite3.connect(dict_db)
c = con.cursor()

c.execute('''
          SELECT pwd FROM dict_attack WHERE hash = ?
          ''', [test_hash])

result = c.fetchone()

if result != None:
    print("password: "+result[0])
else:
    print("attack failed")

print("Time elapsed: %s s" % (time.time() - start_time))
